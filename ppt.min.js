(function(){function k(){}function d(a,b,e,c,h,f,d){this.con=a;this.index=b;this.direction=f||"h";this.duration=e;this.easing=c;this.pptItemEasing=d||0;this.curShowItemIndex=0;this.items=[];this.itemsLen=0;this.lazyitems=[];this.lazyPptItemsLen=0;this.lazyTimer=null;this.lazyShowTime=500;this.events=[];this.onlyOneEndFlag=!0;this.leaveResetItems=h||!0;this.setPptItemEasing();this.init();this.handleEvent()}function c(a){a=a||{};this.direction=a.direction||"h";this.progressBar=a.progressBar||!0;this.transitionType=
a.transitionType||0;this.pptItemEasing=a.pptItemEasing||0;this.transitionType&&0<=parseInt(Number(this.transitionType))&&5>parseInt(Number(this.transitionType))?this.transitionType=parseInt(Number(this.transitionType)):this.transitionType=0;this.actualCurrentIndex=this.curPptIndex=0;this.duration=a.duration||.4;this.easeing=a.easeing||"ease";this.bodyBroundColor=a.bodyBroundColor||"#fff";this.backgroundColor=a.backgroundColor||"#fff";this.defaultColor=a.defaultColor||"";this.leaveResetItems=a.leaveResetItems||
!0;this.ppts=[];this.len=0;this.throttleFlag=!0;this.hashNum=this.showFirstTimer=null;this.dirShowElemnt=[];this.onlyOneBindFullScreenEvent=!0;this.curFullScreenState=!1;this.eventTypes=["end","start"];this.init()}k.prototype={on:function(a,b,e){a.addEventListener(b,e,!1)},setCss:function(a,b){if("Object"==this.getType(b))for(var e in b)a.style[e]=b[e]},getCss:function(a,b){a=window.getComputedStyle?window.getComputedStyle(a,null):a.currentStyle;return b?a[b]:a},$id:function(a){"#"==a[0]&&(a=a.substring(1));
return document.getElementById(a)},attr:function(a,b){return a.getAttribute(b)},html:function(a,b){if(!b)return a.innerHTML;"String"==this.getType(b)&&(a.innerHTML=b)},getType:function(a){a=Object.prototype.toString.call(a);return a.substring(8,a.length-1)}};d.prototype=new k;d.prototype.constructor=d;d.prototype.init=function(){var a=this.con.getElementsByClassName("pptItem");this.itemsLen=a.length;for(var b=0;b<this.itemsLen;b++)this.hidePptItem(a[b]),this.items.push(a[b]);a=this.con.getElementsByClassName("lazyPpt");
this.lazyPptItemsLen=a.length;for(b=0;b<this.lazyPptItemsLen;b++)this.hideLazyShowItem(a[b]),this.lazyitems.push(a[b])};d.prototype.lazyShow=function(){var a=this;clearTimeout(a.lazyTimer);a.lazyTimer=setTimeout(function(){for(var b=0;b<a.lazyitems.length;b++)a.setCss(a.lazyitems[b],{opacity:1,transition:"all "+a.duration+"s "+a.easing+" "+.3*b+"s"}),a.setCss(a.lazyitems[b],a.pptItemStyle.showStyle)},a.lazyShowTime)};d.prototype.hideLazyShowItem=function(a){if(a)this.setCss(a,{opacity:0}),this.setCss(a,
this.pptItemStyle.hideStyle);else for(a=0;a<this.lazyitems.length;a++)this.setCss(this.lazyitems[a],{opacity:0}),this.setCss(this.lazyitems[a],this.pptItemStyle.hideStyle)};d.prototype.hidePptItem=function(a){if(a)this.setCss(a,{opacity:0}),this.setCss(a,this.pptItemStyle.hideStyle);else for(a=0;a<this.items.length;a++)this.setCss(this.items[a],{opacity:0}),this.setCss(this.items[a],this.pptItemStyle.hideStyle)};d.prototype.upEvent=function(){if(0>=this.itemsLen)return!1;0<this.curShowItemIndex&&
this.curShowItemIndex--;this.hideItem(this.curShowItemIndex);0<this.curShowItemIndex&&this.focusPptItem(this.curShowItemIndex-1);this.blurPptItem(this.curShowItemIndex,!1)};d.prototype.downEvent=function(){if(0>=this.itemsLen||this.curShowItemIndex>=this.itemsLen)return!1;this.showItem(this.curShowItemIndex);this.focusPptItem(this.curShowItemIndex);this.blurPptItem(this.curShowItemIndex-1,!0);this.curShowItemIndex<this.itemsLen&&this.curShowItemIndex++};d.prototype.setPptItemEasing=function(){console.log(this.pptItemEasing);
switch(this.pptItemEasing){case 0:this.pptItemStyle={hideStyle:{transform:"scale(1.1)"},showStyle:{transform:"scale(1)","transform-origin":"0 0"}};break;case 1:this.pptItemStyle={hideStyle:{transform:"scale(0.9)"},showStyle:{transform:"scale(1)","transform-origin":"0 0"}};break;case 2:this.pptItemStyle={hideStyle:{transform:"translateX(30px)"},showStyle:{transform:"translateX(0px)"}};break;case 3:this.pptItemStyle={hideStyle:{transform:"translateY(30px)"},showStyle:{transform:"translateY(0px)"}};
break;case 4:this.pptItemStyle={hideStyle:{transform:"translateY(-30px)"},showStyle:{transform:"translateY(0px)"}};break;case 5:this.pptItemStyle={hideStyle:{transform:"rotate(360deg)"},showStyle:{transform:"rotate(0)"}}}};d.prototype.hideItem=function(a){this.setCss(this.items[a],{opacity:0,transition:"all "+this.duration+"s "+this.easing})};d.prototype.showItem=function(a){this.setCss(this.items[a],{opacity:1,transition:"all "+this.duration+"s "+this.easing})};d.prototype.focusPptItem=function(a){this.setCss(this.items[a],
{opacity:1});this.setCss(this.items[a],this.pptItemStyle.showStyle)};d.prototype.blurPptItem=function(a,b){0>a||(b?this.setCss(this.items[a],{opacity:.8}):(this.setCss(this.items[a],{opacity:0}),this.setCss(this.items[a],this.pptItemStyle.hideStyle)))};d.prototype.handleEvent=function(){var a=this,b;b="h"==this.direction?"left":"top";this.on(this.con,"transitionend",function(e){e=a.getCss(a.con,b);if(0==parseInt(e)){if(a.onlyOneEndFlag){a.lazyShow();for(e=0;e<a.events.length;e++)"end"==a.events[e].type&&
a.events[e].fn(a.index+1);a.onlyOneEndFlag=!1}}else a.onlyOneEndFlag=!0,a.hideLazyShowItem(),a.leaveResetItems&&(a.hidePptItem(),a.curShowItemIndex=0)})};c.prototype=new k;c.prototype.constructor=c;c.prototype.init=function(){this.render();this.progressBar&&this.createProgressBar();this.creatDirBox();this.handleDir()};c.prototype.render=function(){var a=this;this.initOtherStyle();var b=document.querySelectorAll(".pptPage");this.len=b.length;for(var e=0;e<this.len;e++)this.initStyle(b[e]),this.hideRightOrBottom(b[e]),
this.ppts.push(new d(b[e],e,this.duration,this.easeing,this.leaveResetItems,this.direction,this.pptItemEasing));this.showFirstTimer=(this.hashNum=this.getHash())&&"number"==typeof Number(this.hashNum)?setTimeout(function(){a.curPptIndex=a.hashNum-1;a.showItem(a.hashNum-1);a.showPageIndex(a.hashNum)},500):setTimeout(function(){a.showItem(0);a.showPageIndex(1)},500)};c.prototype.initStyle=function(a){this.setCss(a,{width:"100%",height:"100%",overflow:"hidden",position:"absolute",top:0,left:0,padding:"20px",
"box-sizing":"border-box","background-color":this.backgroundColor})};c.prototype.initOtherStyle=function(){for(var a=document.getElementsByClassName("pptCenter"),b=0;b<a.length;b++)this.setCss(a[b],{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)"});this.setCss(document.documentElement,{width:"100%",height:"100%",overflow:"hidden"});this.setCss(document.body,{width:"100%",height:"100%",overflow:"hidden","background-color":this.bodyBroundColor})};c.prototype.getAllPpts=function(){return this.ppts};
c.prototype.getPptsLen=function(){return this.len};c.prototype.getPptItemsByIndex=function(a){return"number"!=typeof a||0>=parseInt(a)||parseInt(a)>this.len?!1:this.ppts[a-1].items};c.prototype.getLazyPptsByIndex=function(a){return"number"!=typeof a||0>=parseInt(a)||parseInt(a)>this.len?!1:this.ppts[a-1].lazyitems};c.prototype.computeDefaultColor=function(a){if(this.defaultColor)return this.defaultColor;a=this.getCss(this.ppts[a].con,"background-color");return"rgb(255, 255, 255)"==a||"#fff"==a||"#ffffff"==
a?"#000":"#fff"};c.prototype.showPageIndex=function(a){var b=this;if(this.$id("pptPageIndexShowBox"))e=this.$id("pptPageIndexShowBox");else{var e=document.createElement("div");e.id="pptPageIndexShowBox"}var c="20px";99<this.len&&(c="15px");var h=this.computeDefaultColor(a-1);this.actualCurrentIndex=a-1;this.setCss(e,{right:"10px",bottom:"10px",position:"fixed","z-index":9999,"font-size":c,width:"70px",height:"70px","line-height":"70px","text-align":"center",color:h,border:"1px solid "+h,"border-radius":"50%",
cursor:"pointer"});this.html(e,a+"/"+this.len);document.body.appendChild(e);if(this.onlyOneBindFullScreenEvent){var d=document.getElementById("pptPageIndexShowBox"),g;this.on(d,"mouseenter",function(){g=d.innerHTML;b.setCss(d,{"font-size":"14px"});d.innerHTML=b.curFullScreenState?"\u9000\u51fa\u5168\u5c4f":"\u5355\u51fb\u5168\u5c4f"});this.on(d,"mouseleave",function(){d.innerHTML=g;b.setCss(d,{"font-size":c})});this.on(d,"click",function(){b.curFullScreenState?(b.exitFullScreen(),b.curFullScreenState=
!1):(b.enterFullScreen(),b.curFullScreenState=!0)});this.onlyOneBindFullScreenEvent=!1}};c.prototype.changeHash=function(a){window.location.hash="#"+a};c.prototype.getHash=function(){return window.location.hash.substring(1)};c.prototype.createProgressBar=function(){var a=document.createElement("div");a.id="pptProgressBar";this.setCss(a,{position:"fixed",width:"0",height:"5px",left:0,bottom:0,transition:"width 0.3s ease-in-out"});this.progressBarEle=a;document.body.appendChild(a)};c.prototype.updateProgressBar=
function(a){if(!this.progressBar)return!1;var b=this.computeDefaultColor(a-1);this.setCss(this.progressBarEle,{width:(a-1)/(this.len-1)*100+"%","background-color":b})};c.prototype.hideRightOrBottom=function(a){"v"==this.direction?this.setCss(a,{top:"100%"}):this.setCss(a,{left:"100%"});this.changeCoolStyle(a)};c.prototype.hideLeftOrTop=function(a){"v"==this.direction?this.setCss(a,{top:"-100%"}):this.setCss(a,{left:"-100%"});this.changeCoolStyle(a)};c.prototype.changeCoolStyle=function(a){this.setCss(a,
{transition:"all "+this.duration+"s "+this.easeing});switch(this.transitionType){case 1:this.setCss(a,{opacity:0});break;case 2:this.setCss(a,{transform:"rotate(360deg)"});break;case 3:this.setCss(a,{transform:"scale(1.1)"});break;case 4:this.setCss(a,{transform:"scale(0.8)"})}};c.prototype.changeCoolStyle2=function(a){this.setCss(a,{transition:"all "+this.duration+"s "+this.easeing});switch(this.transitionType){case 1:this.setCss(a,{opacity:1});break;case 2:this.setCss(a,{transform:"rotate(0deg)"});
break;case 3:this.setCss(a,{transform:"scale(1)"});break;case 4:this.setCss(a,{transform:"scale(1)"})}};c.prototype.show=function(a){"v"==this.direction?this.setCss(a,{top:"0%"}):this.setCss(a,{left:"0%"});this.changeCoolStyle2(a)};c.prototype.showItem=function(a){this.hideOther(a);this.show(this.ppts[a].con)};c.prototype.hideLeftItem=function(a){this.hideLeftOrTop(this.ppts[a].con)};c.prototype.hideRightItem=function(a){this.hideRightOrBottom(this.ppts[a].con)};c.prototype.hideOther=function(a){for(var b=
0;b<this.len;b++)b<a?this.hideLeftItem(b):b>a&&this.hideRightItem(b)};c.prototype.handleDir=function(){var a=this;this.on(document,"keyup",function(b){switch(b.keyCode){case 37:a.showWhatKeyUp(1);a.throttle(a.dirLeft,a);break;case 38:a.showWhatKeyUp(2);a.showUp();break;case 39:a.showWhatKeyUp(3);a.throttle(a.dirRight,a);break;case 40:a.showWhatKeyUp(4),a.showDown()}})};c.prototype.showUp=function(){this.ppts[this.curPptIndex].upEvent()};c.prototype.showDown=function(){this.ppts[this.curPptIndex].downEvent()};
c.prototype.dirLeft=function(){0>=this.curPptIndex||(this.curPptIndex--,this.changeComMethod())};c.prototype.dirRight=function(){this.curPptIndex>=this.len-1||(this.curPptIndex++,this.changeComMethod())};c.prototype.changeComMethod=function(){for(var a=this.ppts[this.curPptIndex].events,b=0;b<a.length;b++)"start"==a[b].type&&a[b].fn(this.curPptIndex+1);this.showItem(this.curPptIndex);this.changeHash(this.curPptIndex+1);this.showPageIndex(this.curPptIndex+1);this.updateProgressBar(this.curPptIndex+
1)};c.prototype.autoPlay=function(){};c.prototype.creatDirBox=function(){var a=document.createElement("div");a.id="dirBox";this.setCss(a,{position:"fixed","z-index":999999,right:"10px",bottom:"85px",width:"70px",height:"70px","border-radius":"50%"});var b=document.createElement("div");b.id="leftDirBox";this.setCss(b,{position:"absolute",width:"100%",height:"100%",opacity:0});var e=document.createElement("p");e.className="dirShow1";var c=document.createElement("p");c.className="dirShow2";this.setCss(e,
{width:"30px",height:"10px",background:"#fff",position:"absolute",right:"13px",top:"30px"});this.setCss(c,{width:"0px",height:"0px",position:"absolute",left:"-3px",top:"20px",border:"15px solid transparent","border-right-color":"#fff"});b.appendChild(e);b.appendChild(c);e=document.createElement("div");e.id="rightDirBox";this.setCss(e,{position:"absolute",width:"100%",height:"100%",opacity:0});c=document.createElement("p");c.className="dirShow1";var d=document.createElement("p");d.className="dirShow2";
this.setCss(c,{width:"30px",height:"10px",background:"#fff",position:"absolute",left:"13px",top:"30px"});this.setCss(d,{width:"0px",height:"0px",position:"absolute",left:"43px",top:"20px",border:"15px solid transparent","border-left-color":"#fff"});e.appendChild(c);e.appendChild(d);c=document.createElement("div");c.id="upDirBox";this.setCss(c,{position:"absolute",width:"100%",height:"100%",opacity:0});d=document.createElement("p");d.className="dirShow1";var f=document.createElement("p");f.className=
"dirShow2";this.setCss(d,{width:"10px",height:"30px",background:"#fff",position:"absolute",left:"30px",bottom:"13px"});this.setCss(f,{width:"0px",height:"0px",position:"absolute",left:"20px",top:"-3px",border:"15px solid transparent","border-bottom-color":"#fff"});c.appendChild(d);c.appendChild(f);d=document.createElement("div");d.id="downDirBox";this.setCss(d,{position:"absolute",width:"100%",height:"100%",opacity:0});f=document.createElement("p");f.className="dirShow1";var g=document.createElement("p");
g.className="dirShow2";this.setCss(f,{width:"10px",height:"30px",background:"#fff",position:"absolute",left:"30px",top:"13px"});this.setCss(g,{width:"0px",height:"0px",position:"absolute",left:"20px",top:"43px",border:"15px solid transparent","border-top-color":"#fff"});d.appendChild(f);d.appendChild(g);Array.prototype.push.call(this.dirShowElemnt,b,c,e,d);a.appendChild(b);a.appendChild(e);a.appendChild(c);a.appendChild(d);document.body.appendChild(a)};c.prototype.showWhatKeyUp=function(a){var b=
this;clearTimeout(null);this.changeKeyUpBoxColor(a-1);for(var e=0;e<this.dirShowElemnt.length;e++)e!=a-1&&this.setCss(this.dirShowElemnt[e],{opacity:0});b.setCss(b.dirShowElemnt[a-1],{opacity:1});setTimeout(function(){b.setCss(b.dirShowElemnt[a-1],{opacity:0});b.setCss(document.getElementById("dirBox"),{border:"1px solid transparent"})},1E3)};c.prototype.changeKeyUpBoxColor=function(a){if(0==a){if(0<this.actualCurrentIndex)var b=this.computeDefaultColor(this.actualCurrentIndex-1)}else 2==a?this.actualCurrentIndex<
this.len-1&&(b=this.computeDefaultColor(this.actualCurrentIndex+1)):b=this.computeDefaultColor(this.actualCurrentIndex);var e=this.dirShowElemnt[a],c=e.getElementsByClassName("dirShow1")[0],e=e.getElementsByClassName("dirShow2")[0];this.setCss(c,{background:b});this.setCss(document.getElementById("dirBox"),{border:"1px solid "+b});switch(a){case 0:this.setCss(e,{"border-right-color":b});break;case 1:this.setCss(e,{"border-bottom-color":b});break;case 2:this.setCss(e,{"border-left-color":b});break;
case 3:this.setCss(e,{"border-top-color":b})}};c.prototype.enterFullScreen=function(){var a=document.documentElement;a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen&&a.msRequestFullscreen()};c.prototype.exitFullScreen=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():
document.msExitFullscreen&&document.msExitFullscreen()};c.prototype.addListeners=function(a,b,c){if(-1!=this.eventTypes.indexOf(a))if(b="function"==typeof b?b:function(){},"number"==typeof Number(c)&&0<c&&c<=this.len)this.ppts[c-1].events.push({type:a,fn:b});else for(c=0;c<this.ppts.length;c++)this.ppts[c].events.push({type:a,fn:b})};c.prototype.removeListeners=function(a,b){if(-1!=this.eventTypes.indexOf(a))if("number"==typeof Number(b)&&0<b&&b<=this.len)for(var c=this.ppts[b-1].events,d=0;d<c.length;d++)c[d].type==
a&&(this.ppts[b-1].events.splice(d,1),d--);else for(d=0;d<this.ppts.length;d++)for(_newArr=[],b=0;b<this.ppts[d].events.length;b++)console.log(this.ppts[d].events.length,"aaaaaa"),this.ppts[d].events[b].type==a&&(this.ppts[d].events.splice(b,1),b--)};c.prototype.addBackgroundByIndex=function(a,b){if("number"!==typeof Number(a)||0>=parseInt(Number(a))||parseInt(Number(a))>this.len)return!1;this.setCss(this.ppts[a-1].con,{background:b})};c.prototype.throttle=function(a,b){var c=this;this.throttleFlag&&
(this.throttleFlag=!1,a.call(b),setTimeout(function(){c.throttleFlag=!0},1E3*c.duration))};window.ppt=c})();